# Readme

## Перед запуском
Перед запуском нужно скачать .Net sdk 9 версии, скачать можно по ссылке:
<a href="https://dotnet.microsoft.com/ru-ru/download/dotnet/9.0"/>. 
По сути можно скачать только "Среда выполнения ядра ASP.NET 9.0.8", но если не запустится то качай целый SDK.

## Запуск
При запуске через ярлык приложение запускается на дефолтных портах 5000/5001,
что бы запустить на другом порте открываем консоль в папке и вписываем следующее:
```bash
dotnet UI.dll --urls "http://localhost:8080"
```
вместо `8080` вписываем нужный нам порт.

## Изначальная конфигурация
Перейдите в корень программы и в файле **appsettings.json** найдите секцию **TelegramConfiguration**, она выглядит примерно так:
```json  
    "TelegramConfiguration": {      
      "ApiId": 100000000,      
      "ApiHash": "000000000000000000",      
      "PhoneNumber": "+38000000000000"    
},  
```  
Замените эти данные на свои. Что бы получить ApiId и ApiHash перейдите по ссылке <a href="https://my.telegram.org/apps"/>

## Авторизация в telegram
Далее перейдите на форму авторизации и введите код, который был отослан вам в telegram.  
![{A22E41CC-418B-4BDA-80FD-160362A6C589}.png]({A22E41CC-418B-4BDA-80FD-160362A6C589}.png)
После успешной авторизации вы получите соответствующее сообщение и форма авторизации будет заблокирована.

## Планировщик задания
Что бы запланировать задание, перейдите на форму планировщика. В левой части формы пользователь вводит имя задачи (например «Рассылка цыганской рекламы»), cron – выражение, которое лучше генерировать через chat gpt (ещё лучше сказать ему, что бы генерировал cron с привязкой к библиотеке Quartz.net, так как форматы могут немного отличаться), текст сообщения, а так же картинку (которая не является обезательной).  
![{36AC8545-37C3-48F5-9BC0-053B675DA93E}.png]({36AC8545-37C3-48F5-9BC0-053B675DA93E}.png)

В правой части пользователь выбирает все каналы и чаты для который будет пересылаться сообщение, например, так выглядит правая половина с выбранным каналом «test bota»:  
![{0ACF57A4-39F1-4E71-9E9C-5E6EB6E96A20}.png]({0ACF57A4-39F1-4E71-9E9C-5E6EB6E96A20}.png)

После того как мы определились с задачей и её содержанием нажимаем кнопку «Создать задание». В зависимости от успеха данной операции в левом нижнем углу будет выдано сообщение.

> ОБРАЩАЮ ВАШЕ ОСОБОЕ ВНИМАНИЕ НА ТО, ЧТО ВРЕМЯ НУЖНО УКАЗЫВАТЬ ПО МЕСТНОМУ ПОЯСУ И ЗАДАЧИ ТАК ЖЕ БУДУТ ВЫПОЛНЯТЬСЯ ПО МЕСТНОМУ ПОЯСУ.  
> {style="warning"}

## Список планировщика
В списке планировщика можно посмотреть задачи, время их следующего срабатывания, а также удалить их за ненадобности.  
![{4CBAD6A9-34C1-436A-846E-A30E8E63CE0F}.png]({4CBAD6A9-34C1-436A-846E-A30E8E63CE0F}.png)

## Логи
Логи отображаются в консоли, а так же хранятся в папочке Logs, по умолчанию один файл = один день. Всего хранится 7 файлов, файлы старше удаляются. Если есть особое желание это можно подкрутить в файле **appsettings.json** в секции Serilog, она выглядит примерно так:
```json  
"Serilog": {
    "Using":  [ "Serilog.Sinks.Console", "Serilog.Sinks.File" ],
    "MinimumLevel": "Information",
    "WriteTo": [
        { "Name": "Console" },
        { "Name": "File",
            "Args": {
                "path": "Logs/log.txt",
                "rollingInterval": "Day",
                "retainedFileCountLimit": 7
            }
        }
    ],
    "Enrich": [ "FromLogContext" ]
}, 
```  
> Немного деталей о конфигурации логов. Редактировать на свой страх и риск.

| Параметр                      | Значение / Тип | Описание                                                                         |
| ----------------------------- | -------------- | -------------------------------------------------------------------------------- |
| `Name`                        | строка         | Название синка. Примеры: `"Console"` (вывод в консоль), `"File"` (вывод в файл). |
| `Args`                        | объект         | Аргументы, специфичные для выбранного синка.                                     |
| `Args.path`                   | строка         | Путь к файлу (для синка `"File"`), например `"Logs/log.txt"`.                    |
| `Args.rollingInterval`        | строка         | Интервал ротации файлов: `"Day"`, `"Hour"`, `"Month"` и т.д.                     |
| `Args.retainedFileCountLimit` | число          | Сколько старых файлов хранить. Более старые автоматически удаляются.             |
